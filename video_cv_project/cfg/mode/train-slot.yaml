# @package _global_
# Config for train mode.

defaults:
  - slot-base
  - override /data: kinetics400
  - override /data/transform: base
  - override /model: slot

mode: train

train:
  epochs: 1

  log_every: 50
  save_every: 1000

  dryrun: false

  # TODO: Optimizer/scheduler can be its own sub-config.
  optimizer:
    _target_: torch.optim.Adam
    lr: 0.0001

  scheduler:
    _target_: torch.optim.lr_scheduler.OneCycleLR
    max_lr: ${..optimizer.lr}
    total_steps: ${total_steps}
    pct_start: 0.1

data:
  # cache_path: /home/jovyan/downloads/kinetics400-train.pt
  batch_size: 16
  num_workers: 16
  clips_per_vid: 2
  dataset:
    frames_per_clip: 8
    step_between_clips: ${.frames_per_clip}
    # split: train

  transform:
    patch_func:
      # Done on CPU, cannot use too high batch size.
      device: cpu
      batch_size: 2
